<ion-view view-title="{{'control.profile' | i18next}}" ng-class="ion-view-background">
  <ion-content>
    
    <!-- opcode and logout - this row has two clicks! (and an argument for one of them) -->
    <!-- <div class="control-list-item">
      <div ng-click="copyToClipboard(settings.auth.opcode)" class="control-list-text"><pre>{{settings.auth.opcode}}</pre></div>
      <div ng-click="logOut()" id ="switch-user" class="control-icon-button"><i class="icon ion-log-out"></i></div>
    </div> -->
    <setting-row text-key="settings.auth.opcode" icon-name="'logout'" action = "logOut"></setting-row>

    <!-- demographics survey -- leaving for now -->
    <enketo-demographics-button></enketo-demographics-button>

    <setting-row text-key="'control.view-privacy'" icon-name="'eye'" action = "viewPrivacyPolicy" is-toggle="false"></setting-row>

    <setting-row text-key="'control.view-qrc'" icon-name="'grid'" action = "viewQRCode" is-toggle="false"></setting-row>

    <!-- reminder time -- leaving for now -->
    <div ng-if="settings.notification.prefReminderTime" class="control-list-item">
      <div class="control-list-text">
        {{'control.reminders-time-of-day' | i18next: {time: settings.notification.prefReminderTime} }}
      </div>
      <div class="control-icon-button" style="position: relative">
        <i class="ion-clock"></i>
        <input type="time" name="timeOfDay" value="{{settings.notification.prefReminderTimeOnLoad}}"
          ng-model="settings.notification.prefReminderTimeVal" ng-change="updatePrefReminderTime()" ng-blur="updatePrefReminderTime()"
          style="position: absolute; height: 100%; inset: 0; display: flex; opacity: 0;">
      </div>
    </div>

    <!-- tracking - a toggle! -->
    <!-- <div class="control-list-item">
      <div class="control-list-text" ng-i18next>{{'control.tracking'}}</div>
      <label ng-click="userStartStopTracking()" class="toggle control-list-toggle toggle-color">
        <input type="checkbox" ng-checked="settings.collect.trackingOn">
        <div class="track">
          <div class="handle"></div>
        </div>
      </label>
    </div> -->
    <setting-row text-key="'control.tracking'" icon-name="'toggle-switch'" action = "userStartStopTracking" is-toggle="true" toggle-val="getTracking"></setting-row>

    <setting-row text-key="'control.app-status'" icon-name="'check'" action="fixAppStatus" is-toggle="false"></setting-row>
    
    <!-- accuracy - another toggle! -->
    <!-- <div class="control-list-item">
      <div class="control-list-text" ng-i18next>{{'control.medium-accuracy'}}</div>
      <label ng-click="toggleLowAccuracy()" class="toggle control-list-toggle toggle-color">
        <input type="checkbox" ng-checked="getLowAccuracy()">
        <div class="track">
          <div class="handle"></div>
        </div>
      </label>
    </div> -->
    <setting-row text-key="'control.medium-accuracy'" icon-name="'toggle-switch'" action = "toggleLowAccuracy" is-toggle="true" toggle-val="getLowAccuracy"></setting-row>

    <setting-row text-key="carbonDatasetString" icon-name="'database-cog'" action = "changeCarbonDataset" is-toggle="false"></setting-row>
    <setting-row text-key="'control.force-sync'" icon-name="'sync'" action="forceSync" is-toggle="false"></setting-row>
    <setting-row text-key="'control.share'" icon-name="'share'" action="share" is-toggle="false"></setting-row>

    <setting-row text-key="'control.download-json-dump'" icon-name="'calendar'" action="openDatePicker" is-toggle="false"></setting-row>

    <!-- I'm not sure what getMyData() does or where it's used so I don't know how to convert it!
    It was a part of the downloadDump item, as if a second icon alongside the calendar -->
    <!-- <div ng-click="getMyData()" class="control-icon-button"><i class="ion-android-mail"></i></div>
    <setting-row text-key="'control.download-json-dump'" icon-name="'email'" action="getMyData"></setting-row> -->

    <setting-row ng-if="ui_config.profile_controls.support_upload == true" text-key="'control.upload-log'" icon-name="'cloud'" action="uploadLog"></setting-row>
    <setting-row text-key="'control.email-log'" icon-name="'email'" action="emailLog" is-toggle="false"></setting-row>

    <!-- Dropdown! With map! -->
    <expansion-section section-title="'control.user-data'" section-contents="[{type: 'row', data: [], textKey: 'control.erase-data', action: eraseUserData, iconName: 'delete-forever', isToggle: false},
                                                                              {type: 'table', data: userData, textKey: 'control.erase-data', action: eraseUserData, iconName: 'delete-forever', isToggle: false}]">
    </expansion-section>

    <!-- this dropdown is less smooth than the angular one -- need to work on the visuals :) -->
    <setting-row text-key="'control.dev-zone'" icon-name="'arrow-expand-down'" action="expandDeveloperZone" is-toggle="false"></setting-row>

    <!-- Begin developer zone -->
    <div class="" ng-show="collectionExpanded()">
      
      <setting-row text-key="'control.refresh'" icon-name="'refresh'" action="refreshScreen" is-toggle="false"></setting-row>

      <setting-row text-key="'control.end-trip-sync'" icon-name="'sync-alert'" action="endForceSync" is-toggle="false"></setting-row>

      <setting-row text-key="'control.check-consent'" icon-name="'check'" action="checkConsent" is-toggle="false"></setting-row>

      <setting-row text-key="'control.dummy-notification'" icon-name="'bell'" action="dummyNotification" is-toggle="false"></setting-row>
      
      <setting-row text-key="'control.upcoming-notifications'" icon-name="'bell-check'" action="" is-toggle="false"></setting-row>
      <control-data-table ng-if="settings.notification.prefReminderTime" control-data="settings.notification.scheduledNotifs" is-toggle="false"></control-data-table>

      <setting-row text-key="'control.invalidate-cached-docs'" icon-name="'delete'" action="invalidateCache" is-toggle="false"></setting-row>
      
      <setting-row text-key="'control.nuke-all'" icon-name="'delete-forever'" action="nukeUserCache" is-toggle="false"></setting-row>
      
      <setting-row text-key="parseState(settings.collect.state)" icon-name="'pencil'" action="forceState" is-toggle="false"></setting-row>

      <setting-row text-key="'control.check-log'" icon-name="'arrow-expand-right'" action="showLog" is-toggle="false"></setting-row>

      <setting-row text-key="'control.check-sensed-data'" icon-name="'arrow-expand-right'" action="showSensed" is-toggle="false"></setting-row>
      
      <setting-row text-key="'control.collection'" icon-name="'pencil'" action="editCollectionConfig" is-toggle="false"></setting-row>
      <control-data-table control-data="settings.collect.show_config"></control-data-table>

      <setting-row text-key="'control.sync'" icon-name="'pencil'" action="editSyncConfig" is-toggle="false"></setting-row>
      <control-data-table control-data="settings.sync.show_config"></control-data-table>
    
      <setting-row text-key="'control.app-version'" icon-name="application" action="" is-toggle="false"></setting-row>
      <setting-row text-key="settings.clientAppVer" icon-name="" action="" is-toggle="false"></setting-row>

    </div>
  </ion-content>
</ion-view>
